Namespace(lr=0.001, seed=19260817, data='toys', epoch=20, trn_batch=256, tst_batch=256, con_batch=2048, test_frequency=1, max_seq_len=50, num_reco_neg=40, reg=1e-06, ssl_reg=0.01, latdim=32, mask_depth=3, path_prob=0.5, num_attention_heads=4, num_gcn_layers=2, num_trm_layers=2, load_model=None, num_mask_cand=50, mask_steps=10, eps=0.2, attention_probs_dropout_prob=0.3, hidden_dropout_prob=0.3, save_path='tem')
2023-08-28 14:15:43.132188: Start
2023-08-28 14:15:50.454355: Load Data
2023-08-28 14:15:50.454408: Users: 116429, Items(+1): 54784
2023-08-28 14:15:50.490232: Model Prepared
2023-08-28 14:15:50.490276: Model Initialized
Test result: h5=0.1006 n5=0.0598 h10=0.1988 n10=0.0912 h20=0.3964 n20=0.1405 h50=0.6251 n50=0.188317.98, hr@20 = 82.00, ndcg@20 = 28.65, hr@50 = 131.00, ndcg@50 = 38.89           
2023-08-28 14:28:16.911164: Epoch 0/20, Train: loss = -63.5639, loss_main = 1.1781, loss_reco = -64.7071, loss_mask = -0.3838                   
Test result: h5=0.3775 n5=0.2689 h10=0.4570 n10=0.2950 h20=0.4910 n20=0.3038 h50=0.5194 n50=0.3093= 97.42, hr@20 = 163.00, ndcg@20 = 100.19, hr@50 = 165.00, ndcg@50 = 100.61            
2023-08-28 14:29:01.438950: Epoch 0/20, Test: hr@10 = 0.4570, ndcg@10 = 0.2950, hr@5 = 0.3775, ndcg@5 = 0.2689, hr@20 = 0.4910, ndcg@20 = 0.3038, hr@50 = 0.5194, ndcg@50 = 0.3093                   
2023-08-28 14:29:01.438998: Epoch 20/20, Best Result: hr@10 = 0.4570, ndcg@10 = 0.2950, hr@5 = 0.3775, ndcg@5 = 0.2689, hr@20 = 0.4910, ndcg@20 = 0.3038, hr@50 = 0.5194, ndcg@50 = 0.3093                   
2023-08-28 14:29:01.462924: Model Saved: tem

2023-08-28 14:40:11.684599: Epoch 1/20, Train: loss = -92.5490, loss_main = 0.9651, loss_reco = -93.4794, loss_mask = -0.4184                   
Test result: h5=0.4334 n5=0.3227 h10=0.5407 n10=0.3575 h20=0.6219 n20=0.3782 h50=0.6701 n50=0.3881 = 149.92, hr@20 = 186.00, ndcg@20 = 151.56, hr@50 = 196.00, ndcg@50 = 153.57          
2023-08-28 14:40:54.930584: Epoch 1/20, Test: hr@10 = 0.5407, ndcg@10 = 0.3575, hr@5 = 0.4334, ndcg@5 = 0.3227, hr@20 = 0.6219, ndcg@20 = 0.3782, hr@50 = 0.6701, ndcg@50 = 0.3881                   
2023-08-28 14:40:54.930663: Epoch 20/20, Best Result: hr@10 = 0.5407, ndcg@10 = 0.3575, hr@5 = 0.4334, ndcg@5 = 0.3227, hr@20 = 0.6219, ndcg@20 = 0.3782, hr@50 = 0.6701, ndcg@50 = 0.3881                   
2023-08-28 14:40:54.955019: Model Saved: tem

2023-08-28 14:51:50.583049: Epoch 2/20, Train: loss = inf, loss_main = 0.8631, loss_reco = -103.0082, loss_mask = inf                   
Test result: h5=0.4494 n5=0.3391 h10=0.5639 n10=0.3761 h20=0.6683 n20=0.4026 h50=0.7400 n50=0.4174 = 154.97, hr@20 = 191.00, ndcg@20 = 156.76, hr@50 = 198.00, ndcg@50 = 158.11          
2023-08-28 14:52:33.895592: Epoch 2/20, Test: hr@10 = 0.5639, ndcg@10 = 0.3761, hr@5 = 0.4494, ndcg@5 = 0.3391, hr@20 = 0.6683, ndcg@20 = 0.4026, hr@50 = 0.7400, ndcg@50 = 0.4174                   
2023-08-28 14:52:33.895666: Epoch 20/20, Best Result: hr@10 = 0.5639, ndcg@10 = 0.3761, hr@5 = 0.4494, ndcg@5 = 0.3391, hr@20 = 0.6683, ndcg@20 = 0.4026, hr@50 = 0.7400, ndcg@50 = 0.4174                   
2023-08-28 14:52:33.919500: Model Saved: tem

2023-08-28 15:03:11.836686: Epoch 3/20, Train: loss = inf, loss_main = 0.8221, loss_reco = -106.1660, loss_mask = inf                   
Test result: h5=0.4451 n5=0.3399 h10=0.5449 n10=0.3722 h20=0.6346 n20=0.3950 h50=0.6919 n50=0.4068 = 159.30, hr@20 = 190.00, ndcg@20 = 160.74, hr@50 = 195.00, ndcg@50 = 161.74          
2023-08-28 15:03:55.347079: Epoch 3/20, Test: hr@10 = 0.5449, ndcg@10 = 0.3722, hr@5 = 0.4451, ndcg@5 = 0.3399, hr@20 = 0.6346, ndcg@20 = 0.3950, hr@50 = 0.6919, ndcg@50 = 0.4068                   

2023-08-28 15:14:31.708703: Epoch 4/20, Train: loss = -106.8903, loss_main = 0.8014, loss_reco = -107.6653, loss_mask = -0.3742                   
Test result: h5=0.4345 n5=0.3360 h10=0.5193 n10=0.3635 h20=0.5923 n20=0.3820 h50=0.6415 n50=0.3920 = 156.96, hr@20 = 191.00, ndcg@20 = 158.67, hr@50 = 195.00, ndcg@50 = 159.46          
2023-08-28 15:15:14.348158: Epoch 4/20, Test: hr@10 = 0.5193, ndcg@10 = 0.3635, hr@5 = 0.4345, ndcg@5 = 0.3360, hr@20 = 0.5923, ndcg@20 = 0.3820, hr@50 = 0.6415, ndcg@50 = 0.3920                   

2023-08-28 15:25:56.174759: Epoch 5/20, Train: loss = -107.7099, loss_main = 0.7835, loss_reco = -108.4654, loss_mask = -0.3973                   
Test result: h5=0.4397 n5=0.3400 h10=0.5277 n10=0.3685 h20=0.6061 n20=0.3884 h50=0.6597 n50=0.3993 = 157.03, hr@20 = 189.00, ndcg@20 = 158.53, hr@50 = 196.00, ndcg@50 = 159.96          
2023-08-28 15:26:39.772244: Epoch 5/20, Test: hr@10 = 0.5277, ndcg@10 = 0.3685, hr@5 = 0.4397, ndcg@5 = 0.3400, hr@20 = 0.6061, ndcg@20 = 0.3884, hr@50 = 0.6597, ndcg@50 = 0.3993                   

2023-08-28 15:37:45.537116: Epoch 6/20, Train: loss = -108.1462, loss_main = 0.7706, loss_reco = -108.8962, loss_mask = -0.3310                   
Test result: h5=0.4353 n5=0.3376 h10=0.5217 n10=0.3656 h20=0.5997 n20=0.3853 h50=0.6567 n50=0.3969 = 155.22, hr@20 = 186.00, ndcg@20 = 156.47, hr@50 = 193.00, ndcg@50 = 157.90          
2023-08-28 15:38:28.500198: Epoch 6/20, Test: hr@10 = 0.5217, ndcg@10 = 0.3656, hr@5 = 0.4353, ndcg@5 = 0.3376, hr@20 = 0.5997, ndcg@20 = 0.3853, hr@50 = 0.6567, ndcg@50 = 0.3969                   

2023-08-28 15:48:59.548124: Epoch 7/20, Train: loss = -108.7311, loss_main = 0.7577, loss_reco = -109.4694, loss_mask = -0.3262                   
Test result: h5=0.4360 n5=0.3386 h10=0.5206 n10=0.3661 h20=0.5963 n20=0.3853 h50=0.6474 n50=0.3956 = 156.65, hr@20 = 188.00, ndcg@20 = 157.62, hr@50 = 195.00, ndcg@50 = 159.01          
2023-08-28 15:49:42.526124: Epoch 7/20, Test: hr@10 = 0.5206, ndcg@10 = 0.3661, hr@5 = 0.4360, ndcg@5 = 0.3386, hr@20 = 0.5963, ndcg@20 = 0.3853, hr@50 = 0.6474, ndcg@50 = 0.3956                   

2023-08-28 16:00:40.646235: Epoch 8/20, Train: loss = -108.8444, loss_main = 0.7513, loss_reco = -109.5725, loss_mask = -0.3719                   
Test result: h5=0.4371 n5=0.3392 h10=0.5187 n10=0.3657 h20=0.5904 n20=0.3839 h50=0.6350 n50=0.3929 = 149.03, hr@20 = 186.00, ndcg@20 = 150.83, hr@50 = 191.00, ndcg@50 = 151.81          
2023-08-28 16:01:22.602699: Epoch 8/20, Test: hr@10 = 0.5187, ndcg@10 = 0.3657, hr@5 = 0.4371, ndcg@5 = 0.3392, hr@20 = 0.5904, ndcg@20 = 0.3839, hr@50 = 0.6350, ndcg@50 = 0.3929                   

2023-08-28 16:11:47.467224: Epoch 9/20, Train: loss = -109.2538, loss_main = 0.7450, loss_reco = -109.9720, loss_mask = -0.4145                   
Test result: h5=0.4377 n5=0.3404 h10=0.5220 n10=0.3677 h20=0.6012 n20=0.3878 h50=0.6580 n50=0.3993 = 150.94, hr@20 = 187.00, ndcg@20 = 152.76, hr@50 = 193.00, ndcg@50 = 153.99          
2023-08-28 16:12:29.622729: Epoch 9/20, Test: hr@10 = 0.5220, ndcg@10 = 0.3677, hr@5 = 0.4377, ndcg@5 = 0.3404, hr@20 = 0.6012, ndcg@20 = 0.3878, hr@50 = 0.6580, ndcg@50 = 0.3993                   

2023-08-28 16:22:55.702100: Epoch 10/20, Train: loss = -109.3697, loss_main = 0.7379, loss_reco = -110.0922, loss_mask = -0.3077                   
Test result: h5=0.4343 n5=0.3390 h10=0.5125 n10=0.3644 h20=0.5749 n20=0.3803 h50=0.6129 n50=0.3879 = 149.89, hr@20 = 186.00, ndcg@20 = 151.16, hr@50 = 191.00, ndcg@50 = 152.17          
2023-08-28 16:23:37.893121: Epoch 10/20, Test: hr@10 = 0.5125, ndcg@10 = 0.3644, hr@5 = 0.4343, ndcg@5 = 0.3390, hr@20 = 0.5749, ndcg@20 = 0.3803, hr@50 = 0.6129, ndcg@50 = 0.3879                   

2023-08-28 16:33:57.249438: Epoch 11/20, Train: loss = -109.4926, loss_main = 0.7357, loss_reco = -110.2037, loss_mask = -0.4093                   
Test result: h5=0.4490 n5=0.3470 h10=0.5387 n10=0.3761 h20=0.6203 n20=0.3968 h50=0.6722 n50=0.4074 = 150.55, hr@20 = 187.00, ndcg@20 = 151.55, hr@50 = 193.00, ndcg@50 = 152.80          
2023-08-28 16:34:39.254329: Epoch 11/20, Test: hr@10 = 0.5387, ndcg@10 = 0.3761, hr@5 = 0.4490, ndcg@5 = 0.3470, hr@20 = 0.6203, ndcg@20 = 0.3968, hr@50 = 0.6722, ndcg@50 = 0.4074                   

2023-08-28 16:45:28.483124: Epoch 12/20, Train: loss = inf, loss_main = 0.7332, loss_reco = -110.0663, loss_mask = inf                   
Test result: h5=0.4565 n5=0.3505 h10=0.5574 n10=0.3832 h20=0.6520 n20=0.4072 h50=0.7180 n50=0.4208 = 154.60, hr@20 = 190.00, ndcg@20 = 156.05, hr@50 = 194.00, ndcg@50 = 156.90          
2023-08-28 16:46:11.656117: Epoch 12/20, Test: hr@10 = 0.5574, ndcg@10 = 0.3832, hr@5 = 0.4565, ndcg@5 = 0.3505, hr@20 = 0.6520, ndcg@20 = 0.4072, hr@50 = 0.7180, ndcg@50 = 0.4208                   

2023-08-28 16:56:58.021575: Epoch 13/20, Train: loss = inf, loss_main = 0.7274, loss_reco = -110.1132, loss_mask = inf                   
Test result: h5=0.4585 n5=0.3511 h10=0.5610 n10=0.3843 h20=0.6606 n20=0.4095 h50=0.7378 n50=0.4254 = 151.55, hr@20 = 190.00, ndcg@20 = 153.33, hr@50 = 194.00, ndcg@50 = 154.18          
2023-08-28 16:57:40.612642: Epoch 13/20, Test: hr@10 = 0.5610, ndcg@10 = 0.3843, hr@5 = 0.4585, ndcg@5 = 0.3511, hr@20 = 0.6606, ndcg@20 = 0.4095, hr@50 = 0.7378, ndcg@50 = 0.4254                   

2023-08-28 17:08:15.116471: Epoch 14/20, Train: loss = -109.4773, loss_main = 0.7241, loss_reco = -110.1847, loss_mask = -0.3542                   
Test result: h5=0.4594 n5=0.3522 h10=0.5622 n10=0.3855 h20=0.6613 n20=0.4106 h50=0.7359 n50=0.4259 = 152.04, hr@20 = 192.00, ndcg@20 = 153.82, hr@50 = 194.00, ndcg@50 = 154.23          
2023-08-28 17:08:57.790302: Epoch 14/20, Test: hr@10 = 0.5622, ndcg@10 = 0.3855, hr@5 = 0.4594, ndcg@5 = 0.3522, hr@20 = 0.6613, ndcg@20 = 0.4106, hr@50 = 0.7359, ndcg@50 = 0.4259                   

2023-08-28 17:19:23.315558: Epoch 15/20, Train: loss = -109.5581, loss_main = 0.7195, loss_reco = -110.2664, loss_mask = -0.3063                   
Test result: h5=0.4551 n5=0.3501 h10=0.5529 n10=0.3818 h20=0.6447 n20=0.4051 h50=0.7132 n50=0.4191 = 148.90, hr@20 = 191.00, ndcg@20 = 150.90, hr@50 = 193.00, ndcg@50 = 151.33          
2023-08-28 17:20:05.403761: Epoch 15/20, Test: hr@10 = 0.5529, ndcg@10 = 0.3818, hr@5 = 0.4551, ndcg@5 = 0.3501, hr@20 = 0.6447, ndcg@20 = 0.4051, hr@50 = 0.7132, ndcg@50 = 0.4191                   

2023-08-28 17:30:37.155206: Epoch 16/20, Train: loss = -109.7078, loss_main = 0.7197, loss_reco = -110.4155, loss_mask = -0.3230                   
Test result: h5=0.4557 n5=0.3495 h10=0.5536 n10=0.3812 h20=0.6453 n20=0.4044 h50=0.7132 n50=0.4183 = 152.07, hr@20 = 191.00, ndcg@20 = 153.55, hr@50 = 193.00, ndcg@50 = 153.97          
2023-08-28 17:31:20.602102: Epoch 16/20, Test: hr@10 = 0.5536, ndcg@10 = 0.3812, hr@5 = 0.4557, ndcg@5 = 0.3495, hr@20 = 0.6453, ndcg@20 = 0.4044, hr@50 = 0.7132, ndcg@50 = 0.4183                   

2023-08-28 17:42:02.580458: Epoch 17/20, Train: loss = inf, loss_main = 0.7182, loss_reco = -110.1047, loss_mask = inf                   
Test result: h5=0.4536 n5=0.3480 h10=0.5482 n10=0.3787 h20=0.6363 n20=0.4010 h50=0.6981 n50=0.4137 = 149.05, hr@20 = 190.00, ndcg@20 = 151.01, hr@50 = 192.00, ndcg@50 = 151.44          
2023-08-28 17:42:44.699411: Epoch 17/20, Test: hr@10 = 0.5482, ndcg@10 = 0.3787, hr@5 = 0.4536, ndcg@5 = 0.3480, hr@20 = 0.6363, ndcg@20 = 0.4010, hr@50 = 0.6981, ndcg@50 = 0.4137                   

2023-08-28 17:53:05.600140: Epoch 18/20, Train: loss = -109.5260, loss_main = 0.7140, loss_reco = -110.2244, loss_mask = -0.3721                   
Test result: h5=0.4578 n5=0.3512 h10=0.5585 n10=0.3837 h20=0.6549 n20=0.4082 h50=0.7299 n50=0.4235 = 153.74, hr@20 = 190.00, ndcg@20 = 155.50, hr@50 = 193.00, ndcg@50 = 156.13          
2023-08-28 17:53:47.743163: Epoch 18/20, Test: hr@10 = 0.5585, ndcg@10 = 0.3837, hr@5 = 0.4578, ndcg@5 = 0.3512, hr@20 = 0.6549, ndcg@20 = 0.4082, hr@50 = 0.7299, ndcg@50 = 0.4235                   

2023-08-28 18:04:43.000070: Epoch 19/20, Train: loss = -109.3726, loss_main = 0.7151, loss_reco = -110.0780, loss_mask = -0.3187                   
Test result: h5=0.4591 n5=0.3515 h10=0.5597 n10=0.3841 h20=0.6527 n20=0.4077 h50=0.7183 n50=0.4211 = 148.49, hr@20 = 188.00, ndcg@20 = 151.00, hr@50 = 191.00, ndcg@50 = 151.64          
2023-08-28 18:05:25.509042: Epoch 19/20, Test: hr@10 = 0.5597, ndcg@10 = 0.3841, hr@5 = 0.4591, ndcg@5 = 0.3515, hr@20 = 0.6527, ndcg@20 = 0.4077, hr@50 = 0.7183, ndcg@50 = 0.4211                   

Test result: h5=0.4591 n5=0.3515 h10=0.5597 n10=0.3841 h20=0.6527 n20=0.4077 h50=0.7183 n50=0.4211 = 148.49, hr@20 = 188.00, ndcg@20 = 151.00, hr@50 = 191.00, ndcg@50 = 151.64          
2023-08-28 18:06:08.624465: Epoch 20/20, Test: hr@10 = 0.5597, ndcg@10 = 0.3841, hr@5 = 0.4591, ndcg@5 = 0.3515, hr@20 = 0.6527, ndcg@20 = 0.4077, hr@50 = 0.7183, ndcg@50 = 0.4211                   
2023-08-28 18:06:08.624528: Epoch 20/20, Best Result: hr@10 = 0.5639, ndcg@10 = 0.3761, hr@5 = 0.4494, ndcg@5 = 0.3391, hr@20 = 0.6683, ndcg@20 = 0.4026, hr@50 = 0.7400, ndcg@50 = 0.4174